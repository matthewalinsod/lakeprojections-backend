{% extends "base.html" %}

{% block content %}

<nav class="breadcrumb" aria-label="Breadcrumb">
    <a href="{{ url_for('home') }}">Home</a>
    <span class="breadcrumb-sep">&gt;</span>
    <a href="{{ url_for('lake_overview', lake_slug=lake_slug) }}">{{ lake_name }}</a>
    <span class="breadcrumb-sep">&gt;</span>
    <span aria-current="page">{{ subpage_label }}</span>
</nav>

<div class="current-dam">
    <h2>{{ lake_name }}</h2>
    <p>{{ dam_name }} â€” {{ subpage_label }}</p>
</div>

{% if subpage == 'overview' %}
<div class="card">
    <h3>{{ lake_name }}</h3>
    <p>Use the subpage navigation to view Elevation, Releases, Energy, and 24-Month Study data for {{ dam_name }} and the surrounding Colorado River system operations.</p>
</div>
{% elif subpage == 'elevation' %}
<div class="dashboard-grid single-column">
    <p class="graph-explainer graph-explainer-top">
        {{ lake_name }} elevation data tracks the reservoir water-surface height associated with {{ dam_name }} operations and provides a direct operational signal for storage status in the Colorado River system. On this page, historic observations are paired with forecasted reservoir levels so you can evaluate recent performance and likely near-term direction in one view. The historic segment reflects measured conditions, while the forecast segment extends the trajectory under current planning assumptions used for basin operations. Monitoring Lake Mead elevation, Hoover Dam water levels, and related forecasted reservoir levels supports planning for releases, power generation, and seasonal hydrology shifts. Together, these signals help operators and stakeholders understand present supply conditions and how future water management choices may affect the broader river network.
    </p>

    <div class="card">
        <div class="card-header">
            <h3>Elevation (Historic + Forecast)</h3>

            <div class="range-buttons" id="rangeButtons">
                <button class="range-btn active" data-range="30d">MTD</button>
                <button class="range-btn" data-range="90d">3M</button>
                <button class="range-btn" data-range="365d">YTD</button>
                <button class="range-btn" data-range="5y">5Y</button>
            </div>
        </div>

        <div id="chartElevation" class="chart"></div>
        <div id="g1-message" class="chart-note"></div>
    </div>

    <p class="graph-explainer graph-explainer-bottom">
        To interpret this chart, first identify where the historic record ends and the forecast begins; that transition marks the model cutover from measured data to projected values. Short windows like MTD and 3M are useful for quick operational checks, while YTD and 5Y better reveal structural shifts, seasonality, and drought or recovery patterns. Use the MTD button for current-month sensitivity, 3M for recent trend direction, YTD for annual context, and 5Y for long-range baselines. Forecast segments should be viewed as scenario-guided planning outputs rather than fixed outcomes, especially during rapidly changing runoff or demand conditions. The projection framework aligns with the Bureau of Reclamation 24-Month Study methodology, allowing you to compare observed lake behavior against planning assumptions over time. Reading both segments together helps maintain long-term trend awareness while still supporting near-term operational decisions.
    </p>
</div>
{% elif subpage == 'study' %}
<div class="dashboard-grid single-column">
    <div class="card">
        <div class="card-header">
            <h3>24 Month Study</h3>

            <div class="graph-controls">
                <select id="g2-variable">
                    <option value="elevation">Elevation</option>
                    <option value="release">Release</option>
                    <option value="energy">Energy</option>
                </select>

                <select id="g2-month">
                    <option>Loading...</option>
                </select>
            </div>
        </div>

        <div id="chart24ms" class="chart"></div>
    </div>
</div>
{% elif subpage == 'releases' %}
<div class="dashboard-grid single-column">
    {% if dam in ['davis', 'parker'] %}
    <div class="card">
        <div class="card-header">
            <h3>Release by Hour (CFS)</h3>

            <div class="graph-controls">
                <button type="button" id="g3-prev-day" class="g3-day-nav" aria-label="Previous day">&lt;</button>
                <input type="date" id="g3-date" aria-label="Select release date">
                <button type="button" id="g3-next-day" class="g3-day-nav" aria-label="Next day">&gt;</button>
            </div>
        </div>

        <div id="chartReleaseHourly" class="chart"></div>
        <div id="g3-message" class="chart-note"></div>
    </div>
    {% else %}
    <div class="card">
        <h3>Releases</h3>
        <p>Release-by-hour chart is currently available for Lake Mohave (Davis Dam) and Lake Havasu (Parker Dam).</p>
    </div>
    {% endif %}
</div>
{% elif subpage == 'energy' %}
<div class="dashboard-grid single-column">
    {% if dam in ['davis', 'parker'] %}
    <div class="card">
        <div class="card-header">
            <h3>Hourly Energy by Unit (MWh)</h3>

            <div class="graph-controls">
                <button type="button" id="g4-prev-day" class="g3-day-nav" aria-label="Previous day">&lt;</button>
                <input type="date" id="g4-date" aria-label="Select unit energy date">
                <button type="button" id="g4-next-day" class="g3-day-nav" aria-label="Next day">&gt;</button>
            </div>
        </div>

        <div id="chartEnergyUnitHourly" class="chart"></div>
        <div id="g4-message" class="chart-note"></div>
    </div>
    {% else %}
    <div class="card">
        <h3>Energy</h3>
        <p>Hourly energy-by-unit chart is currently available for Lake Mohave (Davis Dam) and Lake Havasu (Parker Dam).</p>
    </div>
    {% endif %}
</div>
{% endif %}

{% endblock %}
